{"version":3,"sources":["../../src/commands-old/import.js"],"sourcesContent":["const { throwIfFileNotExist, importDataFiles } = require('../utils/helpers');\n\n/**\n * Build database scripts and entity models from oolong files.\n * @param {ServiceContainer} app\n * @param {object} context \n * @property {string} context.gemlPath\n * @property {string} context.modelPath         \n * @property {string} context.scriptPath\n * @property {string} context.manifestPath\n * @property {bool} context.useJsonSource\n * @property {bool} context.saveIntermediate\n * @property {object} context.schemas   \n * @returns {Promise}\n */\nmodule.exports = async (app, context) => {\n    app.log('verbose', `${app.name} import`);\n\n    throwIfFileNotExist(\"modelPath\", context.modelPath);\n    throwIfFileNotExist(\"scriptPath\", context.scriptPath);\n\n    let schemaName = app.option('schema');\n    let dataset = app.option('dataset');\n    let ignoreDuplicate = app.option('ignore');\n\n    let schemaConfig = context.schemas[schemaName];\n    if (!schemaConfig) {\n        throw new Error(`Schema \"${schemaName}\" not found in geml config.`);\n    }\n\n    const db = app.db(schemaName);        \n    \n    const Migrator = require(`../migration/${db.driver}`);\n    const migrator = new Migrator(app, context, db);\n\n    await importDataFiles(migrator, dataset, ignoreDuplicate);  \n};\n"],"names":["throwIfFileNotExist","importDataFiles","require","module","exports","app","context","log","name","modelPath","scriptPath","schemaName","option","dataset","ignoreDuplicate","schemaConfig","schemas","Error","db","Migrator","driver","migrator"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";AAAA,MAAM,EAAEA,mBAAmB,EAAEC,eAAe,EAAE,GAAGC,QAAQ;AAEzD;;;;;;;;;;;;CAYC,GACDC,OAAOC,OAAO,GAAG,OAAOC,KAAKC;IACzBD,IAAIE,GAAG,CAAC,WAAW,CAAC,EAAEF,IAAIG,IAAI,CAAC,OAAO,CAAC;IAEvCR,oBAAoB,aAAaM,QAAQG,SAAS;IAClDT,oBAAoB,cAAcM,QAAQI,UAAU;IAEpD,IAAIC,aAAaN,IAAIO,MAAM,CAAC;IAC5B,IAAIC,UAAUR,IAAIO,MAAM,CAAC;IACzB,IAAIE,kBAAkBT,IAAIO,MAAM,CAAC;IAEjC,IAAIG,eAAeT,QAAQU,OAAO,CAACL,WAAW;IAC9C,IAAI,CAACI,cAAc;QACf,MAAM,IAAIE,MAAM,CAAC,QAAQ,EAAEN,WAAW,2BAA2B,CAAC;IACtE;IAEA,MAAMO,KAAKb,IAAIa,EAAE,CAACP;IAElB,MAAMQ,WAAWjB,QAAQ,CAAC,aAAa,EAAEgB,GAAGE,MAAM,CAAC,CAAC;IACpD,MAAMC,WAAW,IAAIF,SAASd,KAAKC,SAASY;IAE5C,MAAMjB,gBAAgBoB,UAAUR,SAASC;AAC7C"}