{"version":3,"sources":["../../../../../src/apps/test/src/features/apiWrapper.js"],"sourcesContent":["import { Feature } from \"@kitmi/jacaranda\";\nimport http from \"node:http\";\n\nconst statusToError = {\n    400: 'invalid_request',\n    401: 'unauthenticated',\n    403: 'permission_denied',\n    404: 'resource_not_found',\n};\n\nconst unknownError = 'unknown_error';\n\nexport default {\n\n    /**\n     * This feature is loaded at init stage\n     * @member {string}\n     */\n    stage: Feature.SERVICE,\n\n    /**\n     * Load the feature\n     * @param {App} app - The cli app module object\n     * @param {object} settings - Settings of soal client   \n     * @returns {Promise.<*>}\n     */\n    load_: async function (app, settings, name) {\n        const service = {\n            wrapResult: (ctx, result = null, others) => {\n                return {\n                    status: 'success',\n                    ...others,\n                    result,\n                };\n            },\n        \n            wrapError: (ctx, error, others) => {\n                const code = error.code || statusToError[ctx.status] || unknownError;\n                                \n                return {\n                    status: 'error',\n                    ...others,                    \n                    error: {\n                        code,\n                        message: error.expose\n                            ? error.message\n                            : http.STATUS_CODES[ctx.status],\n                        ...(error.info ? { info: error.info }: null)\n                    },\n                };\n            },\n        };\n\n        app.registerService(name, service);\n    }\n};"],"names":["statusToError","unknownError","stage","Feature","SERVICE","load_","app","settings","name","service","wrapResult","ctx","result","others","status","wrapError","error","code","message","expose","http","STATUS_CODES","info","registerService"],"mappings":";;;;+BAYA;;;eAAA;;;2BAZwB;iEACP;;;;;;AAEjB,MAAMA,gBAAgB;IAClB,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;AACT;AAEA,MAAMC,eAAe;MAErB,WAAe;IAEX;;;KAGC,GACDC,OAAOC,kBAAO,CAACC,OAAO;IAEtB;;;;;KAKC,GACDC,OAAO,eAAgBC,GAAG,EAAEC,QAAQ,EAAEC,IAAI;QACtC,MAAMC,UAAU;YACZC,YAAY,CAACC,KAAKC,SAAS,IAAI,EAAEC;gBAC7B,OAAO;oBACHC,QAAQ;oBACR,GAAGD,MAAM;oBACTD;gBACJ;YACJ;YAEAG,WAAW,CAACJ,KAAKK,OAAOH;gBACpB,MAAMI,OAAOD,MAAMC,IAAI,IAAIjB,aAAa,CAACW,IAAIG,MAAM,CAAC,IAAIb;gBAExD,OAAO;oBACHa,QAAQ;oBACR,GAAGD,MAAM;oBACTG,OAAO;wBACHC;wBACAC,SAASF,MAAMG,MAAM,GACfH,MAAME,OAAO,GACbE,iBAAI,CAACC,YAAY,CAACV,IAAIG,MAAM,CAAC;wBACnC,GAAIE,MAAMM,IAAI,GAAG;4BAAEA,MAAMN,MAAMM,IAAI;wBAAC,IAAG,IAAI;oBAC/C;gBACJ;YACJ;QACJ;QAEAhB,IAAIiB,eAAe,CAACf,MAAMC;IAC9B;AACJ"}