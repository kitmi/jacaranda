{"version":3,"sources":["../src/tryRequire.js"],"sourcesContent":["import { createRequire } from 'node:module';\nimport path from 'node:path';\n\nfunction tryRequireBy(packageName, mainModule, throwWhenNotFound) {\n    try {\n        if (typeof mainModule === 'string') {\n            const require2 = createRequire(\n                mainModule.endsWith('/') || mainModule.endsWith('\\\\') ? mainModule : mainModule + path.sep\n            );\n            return require2(packageName);\n        }\n\n        return mainModule.require(packageName);\n    } catch (error) {\n        if (error.code === 'MODULE_NOT_FOUND') {\n            if (throwWhenNotFound) {\n                let pkgPaths = packageName.split('/');\n                let npmPkgName = pkgPaths[0];\n\n                if (npmPkgName.startsWith('.')) {\n                    //path\n                    throw error;\n                }\n\n                if (npmPkgName.startsWith('@') && pkgPaths.length > 1) {\n                    npmPkgName += '/' + pkgPaths[1];\n                }\n\n                let pos1 = error.message.indexOf(\"'\");\n                let realModuleName = error.message.substr(pos1 + 1);\n                let pos2 = realModuleName.indexOf(\"'\");\n                realModuleName = realModuleName.substr(0, pos2);\n\n                if (realModuleName === packageName) {\n                    throw new Error(\n                        `Module \"${packageName}\" not found. Try run \"npm install ${npmPkgName}\" to install the dependency.`\n                    );\n                }\n\n                throw error;\n            }\n\n            return undefined;\n        }\n\n        throw error;\n    }\n}\n\n/**\n * Try require a package module and show install tips if not found.\n * @alias helpers.tryRequire\n * @param {String} packageName\n * @param {String} [basePath] - Base path to find the module\n * @returns {Object}\n */\nfunction tryRequire(packageName, basePath) {\n    if (\n        packageName.startsWith('@') ||\n        path.isAbsolute(packageName) ||\n        // not a path\n        (packageName.indexOf(path.sep) === -1 && !packageName.startsWith('.'))\n    ) {\n        try {\n            return require(packageName);\n        } catch (error) {\n            if (error.code !== 'MODULE_NOT_FOUND') {\n                throw error;\n            }\n        }\n    }\n\n    basePath != null || (basePath = process.cwd());\n\n    return tryRequireBy(packageName, require.main, basePath == null) || tryRequireBy(packageName, basePath, true);\n}\n\nexport default tryRequire;\n"],"names":["tryRequireBy","packageName","mainModule","throwWhenNotFound","require2","createRequire","endsWith","path","sep","require","error","code","pkgPaths","split","npmPkgName","startsWith","length","pos1","message","indexOf","realModuleName","substr","pos2","Error","undefined","tryRequire","basePath","isAbsolute","process","cwd","main"],"mappings":";;;;+BA6EA;;;eAAA;;;4BA7E8B;iEACb;;;;;;AAEjB,SAASA,aAAaC,WAAW,EAAEC,UAAU,EAAEC,iBAAiB;IAC5D,IAAI;QACA,IAAI,OAAOD,eAAe,UAAU;YAChC,MAAME,WAAWC,IAAAA,yBAAa,EAC1BH,WAAWI,QAAQ,CAAC,QAAQJ,WAAWI,QAAQ,CAAC,QAAQJ,aAAaA,aAAaK,iBAAI,CAACC,GAAG;YAE9F,OAAOJ,SAASH;QACpB;QAEA,OAAOC,WAAWO,OAAO,CAACR;IAC9B,EAAE,OAAOS,OAAO;QACZ,IAAIA,MAAMC,IAAI,KAAK,oBAAoB;YACnC,IAAIR,mBAAmB;gBACnB,IAAIS,WAAWX,YAAYY,KAAK,CAAC;gBACjC,IAAIC,aAAaF,QAAQ,CAAC,EAAE;gBAE5B,IAAIE,WAAWC,UAAU,CAAC,MAAM;oBAC5B,MAAM;oBACN,MAAML;gBACV;gBAEA,IAAII,WAAWC,UAAU,CAAC,QAAQH,SAASI,MAAM,GAAG,GAAG;oBACnDF,cAAc,MAAMF,QAAQ,CAAC,EAAE;gBACnC;gBAEA,IAAIK,OAAOP,MAAMQ,OAAO,CAACC,OAAO,CAAC;gBACjC,IAAIC,iBAAiBV,MAAMQ,OAAO,CAACG,MAAM,CAACJ,OAAO;gBACjD,IAAIK,OAAOF,eAAeD,OAAO,CAAC;gBAClCC,iBAAiBA,eAAeC,MAAM,CAAC,GAAGC;gBAE1C,IAAIF,mBAAmBnB,aAAa;oBAChC,MAAM,IAAIsB,MACN,CAAC,QAAQ,EAAEtB,YAAY,kCAAkC,EAAEa,WAAW,4BAA4B,CAAC;gBAE3G;gBAEA,MAAMJ;YACV;YAEA,OAAOc;QACX;QAEA,MAAMd;IACV;AACJ;AAEA;;;;;;CAMC,GACD,SAASe,WAAWxB,WAAW,EAAEyB,QAAQ;IACrC,IACIzB,YAAYc,UAAU,CAAC,QACvBR,iBAAI,CAACoB,UAAU,CAAC1B,gBAChB,aAAa;IACZA,YAAYkB,OAAO,CAACZ,iBAAI,CAACC,GAAG,MAAM,CAAC,KAAK,CAACP,YAAYc,UAAU,CAAC,MACnE;QACE,IAAI;YACA,OAAON,QAAQR;QACnB,EAAE,OAAOS,OAAO;YACZ,IAAIA,MAAMC,IAAI,KAAK,oBAAoB;gBACnC,MAAMD;YACV;QACJ;IACJ;IAEAgB,YAAY,QAASA,CAAAA,WAAWE,QAAQC,GAAG,EAAC;IAE5C,OAAO7B,aAAaC,aAAaQ,QAAQqB,IAAI,EAAEJ,YAAY,SAAS1B,aAAaC,aAAayB,UAAU;AAC5G;MAEA,WAAeD"}