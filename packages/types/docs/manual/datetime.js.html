<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>datetime.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-AppErrors.ApplicationError.html">ApplicationError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-AppErrors.ExposableError.html">ExposableError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-AppErrors.GeneralError.html">GeneralError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-AppErrors.InvalidArgument.html">InvalidArgument</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-AppErrors.InvalidConfiguration.html">InvalidConfiguration</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-DataErrors.DatabaseError.html">DatabaseError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-DataErrors.DuplicateError.html">DuplicateError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-DataErrors.ReferencedNotExist.html">ReferencedNotExist</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-DataErrors.UnexpectedState.html">UnexpectedState</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-DataErrors.ValidationError.html">ValidationError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.BadRequest.html">BadRequest</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.ExternalServiceError.html">ExternalServiceError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.Forbidden.html">Forbidden</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.NotFound.html">NotFound</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.ServerError.html">ServerError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.ServiceUnavailable.html">ServiceUnavailable</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-HttpErrors.Unauthorized.html">Unauthorized</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AppErrors.html">AppErrors</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-DataErrors.html">DataErrors</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-HttpErrors.html">HttpErrors</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">datetime.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { ValidationError, ApplicationError } from './errors';

class T_DATETIME {
    name = 'datetime';
    alias = ['date', 'time', 'timestamp'];
    primitive = true;
    scalar = true;
    defaultValue = new Date(0);
    
    constructor(system) {
        this.system = system;
    }

    validate(value) {
        return value instanceof Date;
    }

    /**
     * Transform a value into a JavaScript Date object.
     * @param {*} value
     * @param {*} meta
     * @param {*} i18n
     * @param {string} [path]
     * @returns {Date|null}
     */
    _sanitize(value, meta, opts) {
        if (value instanceof Date) {
            return value;
        } else {
            const type = typeof value;

            if (type === 'string') {
                if (meta.format) {
                    const parser = this.system.plugins.datetimeParser;
                    if (!parser) {
                        throw new ApplicationError('Missing datetime parser plugin.');
                    }
                    value = parser(value, { format: meta.format, timezone: opts.i18n?.timezone });
                } else {
                    value = new Date(value);
                }
            } else if (type === 'number') {
                value = new Date(value);
            } else if (value.toJSDate) {
                value = value.toJSDate();
            }

            if (isNaN(value)) {
                throw new ValidationError('Invalid datetime value.', {
                    value: null,
                    meta,
                    rawValue: opts.rawValue,
                    i18n: opts.i18n,
                    path: opts.path,
                });
            }
        }

        return value;
    }

    serialize(value) {
        return value?.toISOString();
    }
};

export default T_DATETIME;</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.3</a> on Tue Jun 04 2024 14:45:40 GMT+1000 (Australian Eastern Standard Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
