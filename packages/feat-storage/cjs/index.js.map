{"version":3,"sources":["../src/index.js"],"sourcesContent":["import { Feature } from '@kitmi/jacaranda';\nimport * as Drivers from './drivers';\n\nconst mapOfProviderToDriver = {\n    digitalocean: 'S3v2',\n    aws: 'S3v3',\n    azure: 'Azure',\n};\n\n/**\n * General cloud storage feature\n * @module Feature_Storage\n */\n\nexport default {\n    stage: Feature.SERVICE,\n\n    groupable: true,\n\n    packages: (app, { provider }) => {\n        const Driver = Drivers[mapOfProviderToDriver[provider]];\n        return Driver.packages;\n    },\n\n    /**\n     * Load the feature\n     * @param {App} app - The app module object\n     * @param {object} options - Options for the feature\n     * @property {string} options.provider - Cloud storage vendor.\n     * @property {object} options.options - Storage driver options.\n     * @returns {Promise.<*>}\n     *\n     * @example\n     *\n     * provider: 'digitalocean',\n     * options: {\n     *\n     * }\n     */\n    load_: async function (app, options, name) {\n        const { provider, options: providerOptions } = app.featureConfig(\n            options,\n            {\n                schema: {\n                    provider: { type: 'text', enum: Object.keys(mapOfProviderToDriver) },\n                    options: { type: 'object', optional: true },\n                },\n            },\n            name\n        );\n\n        const Driver = Drivers[mapOfProviderToDriver[provider]];\n        const service = new Driver(app, providerOptions);\n\n        app.registerService(name, service);\n    },\n};\n"],"names":["mapOfProviderToDriver","digitalocean","aws","azure","stage","Feature","SERVICE","groupable","packages","app","provider","Driver","Drivers","load_","options","name","providerOptions","featureConfig","schema","type","enum","Object","keys","optional","service","registerService"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BASA;;;CAGC,GAED;;;eAAA;;;2BAdwB;iEACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEzB,MAAMA,wBAAwB;IAC1BC,cAAc;IACdC,KAAK;IACLC,OAAO;AACX;MAOA,WAAe;IACXC,OAAOC,kBAAO,CAACC,OAAO;IAEtBC,WAAW;IAEXC,UAAU,CAACC,KAAK,EAAEC,QAAQ,EAAE;QACxB,MAAMC,SAASC,QAAO,CAACZ,qBAAqB,CAACU,SAAS,CAAC;QACvD,OAAOC,OAAOH,QAAQ;IAC1B;IAEA;;;;;;;;;;;;;;KAcC,GACDK,OAAO,eAAgBJ,GAAG,EAAEK,OAAO,EAAEC,IAAI;QACrC,MAAM,EAAEL,QAAQ,EAAEI,SAASE,eAAe,EAAE,GAAGP,IAAIQ,aAAa,CAC5DH,SACA;YACII,QAAQ;gBACJR,UAAU;oBAAES,MAAM;oBAAQC,MAAMC,OAAOC,IAAI,CAACtB;gBAAuB;gBACnEc,SAAS;oBAAEK,MAAM;oBAAUI,UAAU;gBAAK;YAC9C;QACJ,GACAR;QAGJ,MAAMJ,SAASC,QAAO,CAACZ,qBAAqB,CAACU,SAAS,CAAC;QACvD,MAAMc,UAAU,IAAIb,OAAOF,KAAKO;QAEhCP,IAAIgB,eAAe,CAACV,MAAMS;IAC9B;AACJ"}