{"version":3,"sources":["../../src/serverFeatures/engine.js"],"sourcesContent":["import Feature from '../Feature';\nimport { isEmpty } from '@kitmi/utils';\n\nexport default function (server, options) {\n    const { type, middlewares, ..._options } = options;\n    const Engine = server.tryRequire('@kitmi/adapters')[type];\n\n    return {\n        stage: Feature.INIT,\n\n        packages: Engine.packages,\n\n        load_: async function (server) {\n            server.engine = new Engine(server);\n            if (!isEmpty(middlewares)) {\n                server.once('before:Plugins', () => {                    \n                    server.useMiddlewares_(server.engine, middlewares);\n                });                \n            }\n            await server.engine.init_(_options);\n        },\n    };\n}\n"],"names":["server","options","type","middlewares","_options","Engine","tryRequire","stage","Feature","INIT","packages","load_","engine","isEmpty","once","useMiddlewares_","init_"],"mappings":";;;;+BAGA;;;eAAA;;;gEAHoB;uBACI;;;;;;AAET,SAAf,SAAyBA,MAAM,EAAEC,OAAO;IACpC,MAAM,EAAEC,IAAI,EAAEC,WAAW,EAAE,GAAGC,UAAU,GAAGH;IAC3C,MAAMI,SAASL,OAAOM,UAAU,CAAC,kBAAkB,CAACJ,KAAK;IAEzD,OAAO;QACHK,OAAOC,gBAAO,CAACC,IAAI;QAEnBC,UAAUL,OAAOK,QAAQ;QAEzBC,OAAO,eAAgBX,MAAM;YACzBA,OAAOY,MAAM,GAAG,IAAIP,OAAOL;YAC3B,IAAI,CAACa,IAAAA,cAAO,EAACV,cAAc;gBACvBH,OAAOc,IAAI,CAAC,kBAAkB;oBAC1Bd,OAAOe,eAAe,CAACf,OAAOY,MAAM,EAAET;gBAC1C;YACJ;YACA,MAAMH,OAAOY,MAAM,CAACI,KAAK,CAACZ;QAC9B;IACJ;AACJ"}